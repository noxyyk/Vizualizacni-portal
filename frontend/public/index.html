<!DOCTYPE html>
<html lang="cz">


<head>
  <meta charset="utf-8"> <!--Define UTF-8 Characters-->
  <meta name="viewport" content="width=device-width">
  <title>Vizualizační Portál</title>
  <link type="text/css" rel="stylesheet" href="./themes.css"> <!--define stylesheet-->
  <link type="text/css" rel="stylesheet" href="./button.css">
  <link rel="icon" type="image/x-icon" href="./images/logo.png">
  <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      document.querySelector('.loading-spinner').style.display = 'flex';
  });
  window.onload = function() {
    var i = 1;
    var intervalId = setInterval(() => {
        document.querySelector('.loading-spinner').style.backgroundColor = `rgba(255, 255, 255, ${i})`;
        i -= 0.1;
        if (i <= 0) {
            clearInterval(intervalId);
            document.querySelector('.loading-spinner').style.display = 'none';
        }
    }, 20);
  }
  </script>
</head>

<body> 
  <style>
    .loading-spinner {
  display: flex;
  justify-content: center;
  align-items: center;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5);
  transition: background-color 2s ease;
  z-index: 9999;
}
.loading-spinner:before {
  content: "";
  border: solid 2px transparent;
  border-top-color: #3498db;
  border-left-color: #3498db;
  border-radius: 50%;
  width: 50px;
  height: 50px;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% {
      transform: rotate(0deg);
  }
  100% {
      transform: rotate(360deg);
  }
}
.logo:hover{
  transform: rotate(360deg);
  transition: 1s;
}
.plan {
  display: flex; /* Add flexbox to the parent container */
  flex-direction: column; /* Make the flexbox a column */
  text-align: center;
  border: var(--article_border);
  border-radius: 10px;
  background-color: var(--button_clr);
  padding: 0px;
  padding-left: 10px;
  padding-right: 10px;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
  transition: 0.5s;
}

.plan:hover {
  transform: scale(1.025);
  transition: 0.5s;
}

.plan h3 {
  font-size: 20px;
  font-weight: 600;
}

.plan ul {
  padding: 0;
  list-style: none;
}

.plan ul li {
  font-size: 14px;
}

.plan button {
  margin: 0 auto;
  margin-top: auto; /* Push the button to the bottom of the container */
  cursor: pointer;
}


  </style>
<div class="loading-spinner"></div>
<div class="header" id="header"></div>
<div class="articles">
  <div class="article">
    <h2>Vizualizace pro vaše data</h2>
    <p>Tento portál slouží pro zobrazení a následné zpracování dat do grafů. <br>Pomůcka pro studenty Internetu Věcí. </p>
    <div style="text-align: center;position: relative;top: -5px;"> <button type="button" class="startbtn" onclick=start()>Začít!</button></div>
  </div>
</div>

  <div class="articles">
    <div class="article scroll" id="about" style="position: relative;top: 140px;">
      <h2>O projektu</h2> 
        <p>
            <p>Projekt je vytvořený pro studenty Internetu Věcí na SPŠE Plzeň</p>
            <input id="show" type=checkbox>
              <div id="content">
                <label id="content_label" for="show"><b>Zobrazit méně</b></label>
                <p id="content_text">Tato práce se zabývá a následně zpracovává data z IoT zařízení, které jsou možné nastavit ve Vizualizačním IoT portálu (dále jen portál), pro správný přenos dat. Data následně budou zpracovány pro zobrazení v grafech, maximální, minimální či průměrná hodnota, uživatel si může pomocí API tyto data následně zpracovat. Pro zabezpečení je možnost přihlášení kde je šifrované. Data s přihlášením jsou ukládána do NoSQL databáze MongoDB a klíč je uložen do souboru environmental variable. Jako uživatelská administrace je možno se přihlásit, registrovat, změnit profilový obrázek, změnit heslo nebo smazání účtu a všech dat. Aplikace komunikuje mezi frontend a backend pomocí protokolu HTTP. Je možno zobrazit historii změn, jak se na projektu pracovalo. K dispozici je také návod, jak web používat. Jako administrace zařízení je možno přidat, spravovat, odstranit zařízení, počet zařízení podle druhu plánu.</p>  
              </div>
       <label for="show" id="more"><b>Zobrazit více</b></label>
    </div>
    <div class="article scroll" id="setup" style="position: relative;top: 140px;">
      <h2>Zařízení</h2> 
      <p>Na portálu si můžete přidávat vlastní IoT zařízení a následně zobrazit jejich data pomocí grafů, nebo získat zpracované data pomocí API, které můžete použít pro další zpracování, například do vlastní aplikace nebo webové stránky. Každé zařízení má svůj vlastní klíč, který je potřeba pro přístup k datům. Klíč je uložen v databázi a je možné jej získat pomocí API. 
      Pro každého je možné si přidat až 3 zařízení zdarma, pokud chcete přidat další, musíte si zakoupit plán.
<div class="grid_container">
    <div class="grid_item plan">
          <h3>Osobní</h3>
          <b>Navždy zdarma</b>
          <ul>
            <li>
              Pro uživatele, kteří chtějí základní funkce pro škálování veřejných projektů.
            </li>
            <li>
              <b>3 zařízení</b>
            </li>
            <li>
              10 API dotazů za den
            </li>
          </ul>
          <button type="button" onclick="plan(1)" class="btn">Začít s osobním</button>
        </div>
        <div class="grid_item plan">
          <h3>Pokročilý</h3>
          <b>Dohodou</b>
          <ul>
            <li>
              Možnost přidat spolupracovníky
            </li>
            <li>
              <b>5 zařízení</b>
            </li>
            <li>
              100 API dotazů za den
            </li>
          </ul>
          <button type="button" onclick="plan(2)" class="btn">Začít s pokročilým</button>
      </div>
      <div class="grid_item plan">
        <h3>Profesionální</h3>
        <b>Pro vlastní ceny</b>
        <ul>
          <li>
            Pro týmy s vyššími nároky
          </li>
        </ul>
        <button type="button" onclick="plan(3)" class="btn">Kontaktujte nás</button>
      </div>
</div>
      </p>
    </div>
  </div>
  <div class="footer" id="footer"><div class="footer_default"><p>Copyright © 2023 Tomáš Setunský, SPŠE Plzeň <a href="/tos">Podmínky služby</a> | <a href="/tos#zasady">zásady ochrany osobních údajů</a></p></div></div>
  <script>  
    if (!localStorage.getItem('user')) {
      isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
if (isMobile) {
  var downloadLink = "./files/Vizualizacni portal.apk";
var message = "Pro lepší zobrazení stránky si stáhněte aplikaci.";
var appDownloadHTML = '<div id="app-download-message" style="position: fixed; bottom: 0; left: 0; right: 0; background-color: #f2f2f2; padding: 10px; display: flex; flex-wrap: wrap; justify-content: center; align-items: center;">' + 
                      '<p style="margin: 0; width: 100%; text-align: center;">' + message +'</p>' +
                      '<div style="display: flex; justify-content: center; align-items: center;">' +
                        '<a href="' + downloadLink + '" style="background-color: var(--background_clr); color: black; padding: 8px 16px; text-decoration: none; display: inline-flex; align-items: center; border-radius: 5px; margin-left: 10px;"> <ion-icon name="download-outline" style="margin-right: 10px;"></ion-icon>Stáhnout</a>' + 
                        '<button onclick="dismissAppDownload()" style="background-color: transparent; border: none; padding: 0; margin-left: 10px; display: inline-flex; align-items: center;"><ion-icon name="close-outline" style="margin-right: 5px;"></ion-icon>Zavřít</button>' +
                      '</div>' +
                    '</div>';

// Add a media query for smaller screens
var appDownloadCSS = '<style>@media only screen and (max-width: 600px) {#app-download-message {flex-direction: column; align-items: center;} #app-download-message a, #app-download-message button {margin-top: 10px;}}</style>';
document.head.insertAdjacentHTML('beforeend', appDownloadCSS);

document.body.insertAdjacentHTML('beforeend', appDownloadHTML);

  function dismissAppDownload() {
  var appDownloadElement = document.querySelector("#app-download-message");
  if (appDownloadElement) {
    appDownloadElement.style.display = "none";
  }
}
	} else {
		console.log("This user is on a desktop device.", navigator.userAgent);
	}

}
    function plan(id) {
      if (localStorage.getItem("user") == null && id != 3) return register()
      if (id == 3){
        Swal.fire({
                    title: 'Kontaktujte nás',  
                    html: `<form><input id="name" class="swal2-input" placeholder="Jméno">
                      <form><input id="surname" class="swal2-input" placeholder="Příjmení">
                    <input id="email" class="swal2-input" placeholder="Email">
                    <input id="company" class="swal2-input" placeholder="Firma"></form>
                    <select id="company_size" class="swal2-input" placeholder="Velikost firmy"
                    <option value="0">Velikost firmy</option>
                    <option value="1">1-10 zaměstnanců</option>
                    <option value="2">11-50 zaměstnanců</option>
                    <option value="3">51-250 zaměstnanců</option>
                    <option value="4">251-1k zaměstnanců</option>
                    <option value="5">1k+ zaměstnanců</option>
                    </select>
                    `,
                    showCancelButton: true,
                    confirmButtonText: 'Odeslat',
                    cancelButtonText: 'Zrušit',
                    focusConfirm: false,
                    preConfirm: () => {
                      fetch(page + '/contact',{method: 'POST',
                        headers: {
                          'Content-Type': 'application/json',
                          'Authorization': 'Bearer ' + JSON.parse(localStorage.getItem('user')).token
                        },
                        body: JSON.stringify({
                          name: Swal.getPopup().querySelector('#name').value,
                          surname: Swal.getPopup().querySelector('#surname').value,
                          email: Swal.getPopup().querySelector('#email').value,
                          company: Swal.getPopup().querySelector('#company').value,
                          company_size: Swal.getPopup().querySelector('#company_size').value,
                        }),})
                            .then(response => response.json())              
                            .then(data => {
                              if (data.error) {
                                Swal.fire("Chyba", data.response, "error")
                              } else {
                                Swal.fire("Zpráva odeslána", "Zpráva byla odeslána", "success")
                              }
                            })
                            .catch((error) => {
                              Swal.fire("Chyba", "Nastala chyba při odesílání zprávy", "error")
                            });
                    }
                  })
                  return
      }
      let user = JSON.parse(localStorage.getItem("user"))
      if (user.admin) return Swal.fire("Chyba", "Nemůžete si zakoupit plán, protože jste administrátor", "error")
      switch (id) {
        case 2:
          if (user.role == "advanced") return window.location.href = "./zarizeni.html";
          if (user.role == "user") {
            Swal.fire({
    title: 'Zvýšení plánu',
    input: 'checkbox',
    inputValue: 0,
    inputPlaceholder: 'Opravdu chcete zvýšit plán?',
    showCancelButton: true,
    preConfirm: async () => {
      if (!Swal.getPopup().querySelector('#swal2-checkbox').checked) return Swal.showValidationMessage(`Musíte zaškrtnout políčko`)
      if (user.payment == null) return Swal.fire("Chyba", "Nemáte zaplacený plán", "error")
      fetch(page + '/role',{method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          "Authorization": `Bearer ${JSON.parse(localStorage.getItem("user")).token}`
        },
        body: JSON.stringify({
          role: "advanced",
          type: "buy"
        }),})
            .then(response => response.json())              
            .then(data => {
              if (data.error) {
                Swal.fire("Chyba", data.error, "error")
              } else {
                localStorage.setItem("role", "advanced")
                localStorage.setItem("plan", 2)
                Swal.fire("Plán byl zvýšen", "Plán byl zvýšen na pokročilý", "success")
              }
            })
            .catch((error) => {
              Swal.fire("Chyba", "Nastala chyba při zvyšování plánu", "error")
            });
                                }
})
          }
          if (user.role != "admin") break
        case 1:
          if (user.role == "user") return window.location.href = "./zarizeni.html";
          Swal.fire({
		title: 'Snížení plánu',
		input: 'checkbox',
		inputValue: 0,
		inputPlaceholder: 'Opravdu chcete snížit plán?',
		showCancelButton: true,
		confirmButtonText: 'Snížit',
		preConfirm: async () => {
      if (!Swal.getPopup().querySelector('#swal2-checkbox').checked) return Swal.showValidationMessage(`Musíte zaškrtnout políčko`)
						fetch(page + '/role',{method: 'POST',
							headers: {
								'Content-Type': 'application/json',
                "Authorization": `Bearer ${JSON.parse(localStorage.getItem("user")).token}`
							},
							body: JSON.stringify({
								role: id == 1 ? "user" : "advanced",
                type: "buy"
							}),})
                                  .then(response => response.json())              
                                  .then(data => {
                                    if (data.error) {
                                      Swal.fire("Chyba", data.error, "error")
                                    } else {
                                      localStorage.setItem("role", "user")
                                      localStorage.setItem("plan", 1)
                                      Swal.fire("Plán byl snížen", "Plán byl snížen na osobní", "success")
                                    }
                                  })
                                  .catch((error) => {
                                    Swal.fire("Chyba", "Nastala chyba při snižování plánu", "error")
                                  });
                                                      }
	})
          break;
      }
    }
  </script>
  <script src="animations.js"></script>  
  <script src= ./website.js></script>
  <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="script.js"></script>
  <script src="./files/changelog.js"></script>
</body>

</html>